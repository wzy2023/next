(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1811],{26768:(e,t,s)=>{"use strict";s.d(t,{y:()=>n});let l=e=>{let t;let s=new Set,l=(e,l)=>{let n="function"==typeof e?e(t):e;if(!Object.is(n,t)){let e=t;t=(null!=l?l:"object"!=typeof n||null===n)?n:Object.assign({},t,n),s.forEach(s=>s(t,e))}},n=()=>t,a={setState:l,getState:n,getInitialState:()=>r,subscribe:e=>(s.add(e),()=>s.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},r=t=e(l,n,a);return a},n=e=>e?l(e):l},80108:(e,t,s)=>{"use strict";s.d(t,{c:()=>l});let l=[{label:"全部",value:void 0},{label:"启用",value:!0},{label:"禁用",value:!1}]},84509:(e,t,s)=>{"use strict";e.exports=s(99172)},85493:(e,t,s)=>{"use strict";s.d(t,{vt:()=>d});var l=s(26768),n=s(7620),a=s(84509);let{useDebugValue:r}=n,{useSyncExternalStoreWithSelector:i}=a,u=!1,o=e=>e,c=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?(0,l.y)(e):e,s=(e,s)=>(function(e,t=o,s){s&&!u&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),u=!0);let l=i(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,s);return r(l),l})(t,e,s);return Object.assign(s,t),s},d=e=>e?c(e):c},85779:(e,t,s)=>{Promise.resolve().then(s.bind(s,94885))},94885:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var l=s(54568),n=s(7620),a=s(53979),r=s(30538),i=s(20667);let u=e=>{let{item:t,onSuccess:s}=e,[u]=a.lVW.useForm(),[o,{setTrue:c,setFalse:d}]=(0,r.useBoolean)(!1),{createState:f,updateState:x}=(0,i.sk)({list:!1,create:{onSuccess:()=>{null==s||s(),u.setFieldsValue({title:"",content:""})}},update:{onSuccess:()=>{h(),null==s||s()}}});(0,n.useEffect)(()=>{t&&o?u.setFieldsValue({title:t.title,content:t.content,enabled:t.enabled,tags:t.tags}):u.resetFields()},[u,t,o]);let h=()=>{d(),u.resetFields()},m=async()=>{await u.validateFields();let e=u.getFieldsValue();t?x.mutate(t.id,e):f.mutate(e)};return(0,l.jsxs)(l.Fragment,{children:[t?(0,l.jsx)(a.$nd,{type:"text",icon:(0,l.jsx)(a.xjh,{}),onClick:c}):(0,l.jsx)(a.$nd,{type:"primary",icon:(0,l.jsx)(a.bW0,{}),onClick:c,children:"添加信息"}),(0,l.jsx)(a._s,{title:t?"编辑信息":"新建信息",open:o,onClose:h,width:"80%",extra:(0,l.jsx)(a.$nd,{type:"primary",onClick:m,loading:f.isPending||x.isPending,children:"保存"}),children:(0,l.jsx)(a.kyL,{form:u,submitter:!1,layout:"horizontal",labelCol:{span:1},columns:[{title:"状态",dataIndex:"enabled",valueType:"switch",initialValue:!0},{title:"标题",dataIndex:"title",formItemProps:{rules:[{required:!0,message:"请输入标题"}]}},{title:"标签",dataIndex:"tags",valueType:"select",fieldProps:{mode:"tags",placeholder:"输入标签后按回车"}},{title:"内容",dataIndex:"content",valueType:"textarea",fieldProps:{rows:30},formItemProps:{rules:[{required:!0,message:"请输入内容"}]}}]})})]})},o=e=>{let{id:t,onSuccess:s}=e,{removeState:n}=(0,i.sk)({list:!1,remove:{onSuccess:s}});return(0,l.jsx)(a.iS5,{title:"确定删除该信息吗？",onConfirm:()=>{n.mutate(t)},okText:"确定",cancelText:"取消",children:(0,l.jsx)(a.$nd,{type:"link",danger:!0,icon:(0,l.jsx)(a.SUY,{})})})},c=e=>{let{list:t,onSuccess:s}=e,{updateState:n}=(0,i.sk)({list:!1,update:{onSuccess:s}}),r=(e,t)=>{n.mutate(t.id,{enabled:e})},c=e=>{navigator.clipboard.writeText(e),a.iUO.success("内容已复制")};return(0,l.jsx)(a.fI1,{gutter:[16,16],children:(t||[]).map(e=>{var t;return(0,l.jsx)(a.fvL,{xs:24,md:12,lg:6,children:(0,l.jsxs)(a.ZpM,{size:"small",title:(0,l.jsxs)(a.$xS,{style:{width:"100%"},children:[(0,l.jsx)(a.vwO,{color:e.enabled?"success":"error",children:e.enabled?"启用":"禁用"}),(0,l.jsx)("div",{children:e.title})]}),extra:(0,l.jsx)(a.dOG,{size:"small",checked:e.enabled,onChange:t=>r(t,e)}),actions:[(0,l.jsx)(a.$nd,{type:"text",title:"复制内容",icon:(0,l.jsx)(a.wq3,{}),onClick:()=>c(e.content||"")},"copy"),(0,l.jsx)(u,{item:e,onSuccess:s},"edit"),(0,l.jsx)(o,{id:e.id,onSuccess:s},"delete")],children:[(0,l.jsx)("div",{className:"mb-3",children:null===(t=e.tags)||void 0===t?void 0:t.map(e=>(0,l.jsx)(a.vwO,{className:"mr-1 mb-1",children:e},e))}),(0,l.jsx)("div",{className:"mb-3",children:(0,l.jsx)(a.o5u.Paragraph,{ellipsis:{rows:5},children:e.content})})]})},e.id)})})};var d=s(80108);let f=(0,s(85493).vt)(e=>({filterValues:{enabled:void 0,title:"",tag:""},setFilterValues:t=>{e(e=>({filterValues:{...e.filterValues,...t}}))}})),x=()=>{let{filterValues:e,setFilterValues:t}=f(),s=(0,n.useMemo)(()=>{let t={};return void 0!==e.enabled&&(t.enabled=e.enabled),e.title&&(t.title={contains:e.title}),e.tag&&(t.tags={equals:[e.tag]}),t},[e]),{listState:r}=(0,i.sk)({list:{query:{where:s,orderBy:{createdAt:"desc"}}}}),o=(0,n.useMemo)(()=>{if(!r.data)return[];let e=new Set;return r.data.forEach(t=>{t.tags&&Array.isArray(t.tags)&&t.tags.forEach(t=>e.add(t))}),Array.from(e).map(e=>({label:e,value:e}))},[r.data]);return(0,l.jsxs)("div",{className:"p-5 mx-auto",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-medium text-gray-900",children:"信息管理"}),(0,l.jsx)(u,{onSuccess:r.refetch})]}),(0,l.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-4 w-full",children:[(0,l.jsx)(a.aaP,{value:e.enabled,options:d.c,style:{width:300},onChange:e=>t({enabled:e})}),(0,l.jsx)(a.l6P,{placeholder:"根据标签筛选",allowClear:!0,style:{width:300},value:e.tag,options:o,onChange:e=>t({tag:e})}),(0,l.jsx)(a.pde,{placeholder:"搜索标题",allowClear:!0,value:e.title,onChange:e=>t({title:e.target.value}),onPressEnter:()=>r.refetch()})]})}),(0,l.jsx)(a.tKH,{spinning:r.isLoading,delay:100,children:(0,l.jsx)(c,{list:r.data,onSuccess:r.refetch})})]})}},99172:(e,t,s)=>{"use strict";var l=s(7620),n=s(13100),a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},r=n.useSyncExternalStore,i=l.useRef,u=l.useEffect,o=l.useMemo,c=l.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,s,l,n){var d=i(null);if(null===d.current){var f={hasValue:!1,value:null};d.current=f}else f=d.current;var x=r(e,(d=o(function(){function e(e){if(!u){if(u=!0,r=e,e=l(e),void 0!==n&&f.hasValue){var t=f.value;if(n(t,e))return i=t}return i=e}if(t=i,a(r,e))return t;var s=l(e);return void 0!==n&&n(t,s)?(r=e,t):(r=e,i=s)}var r,i,u=!1,o=void 0===s?null:s;return[function(){return e(t())},null===o?void 0:function(){return e(o())}]},[t,s,l,n]))[0],d[1]);return u(function(){f.hasValue=!0,f.value=x},[x]),c(x),x}}},e=>{var t=t=>e(e.s=t);e.O(0,[6854,6410,541,6771,2602,1598,1815,8259,1210,2998,6502,5888,4030,794,9223,4033,9565,2983,3651,1026,959,5229,5533,667,587,8315,7358],()=>t(85779)),_N_E=e.O()}]);