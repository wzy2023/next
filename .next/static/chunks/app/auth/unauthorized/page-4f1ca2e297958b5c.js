(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2140],{7811:(e,l,s)=>{"use strict";s.d(l,{W:()=>w,p:()=>b});var t=s(54568),a=s(7620),r=s(27261),i=s.n(r),n=s(62942),c=s(89223),o=s(54458),d=s(27524),u=s(72536),h=s(59799),x=s(22049),m=s(16918),f=s(53067),v=s(99624),p=s(83439),j=s(7690),g=s(26283),y=s(46246);let A={BASE:"基础",AI:"AI",OTHER:"其它"},w=[{key:"habit",title:"习惯管理",path:"/habit/manage",icon:(0,t.jsx)(d.A,{}),group:A.BASE,allowedRoles:["admin"]},{key:"task",title:"任务规划",path:"/task",icon:(0,t.jsx)(u.A,{}),group:A.BASE,allowedRoles:["admin"]},{key:"buttons",title:"按钮大盘",path:"/buttons/cma9f76o7001d138o5rq707ls",icon:(0,t.jsx)(h.A,{}),group:A.OTHER,allowedRoles:["admin"]},{key:"order-demand",title:"订单兼职",path:"/order-demand",icon:(0,t.jsx)(x.A,{}),group:A.OTHER,allowedRoles:["admin"]},{key:"collecting",title:"资料收集",path:"/collecting",icon:(0,t.jsx)(m.A,{}),group:A.OTHER,allowedRoles:["admin"]},{key:"rss",title:"RSS信息",path:"/rss",icon:(0,t.jsx)(f.A,{}),group:A.OTHER,allowedRoles:["admin"]},{key:"info",title:"信息管理",path:"/info",icon:(0,t.jsx)(v.A,{}),group:A.AI,allowedRoles:["admin"]},{key:"role",title:"角色管理",path:"/role",icon:(0,t.jsx)(p.A,{}),group:A.AI,allowedRoles:["admin"]}],b=()=>{let e=(0,a.useRef)(null),l=(0,n.usePathname)(),{data:s}=(0,c.useSession)(),[r,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(0);(0,a.useEffect)(()=>{if(!e.current)return;let l=new ResizeObserver(e=>{for(let l of e)h(l.contentRect.width)});return l.observe(e.current),()=>{l.disconnect()}},[]);let x=e=>l.startsWith(e.split("/").slice(0,2).join("/")),m=u>180,f=w.filter(e=>{var l;return null===(l=e.allowedRoles)||void 0===l||!l.length||e.allowedRoles.includes((null==s?void 0:s.user.role)||"")}).reduce((e,l)=>{let s=l.group||"其他";return e[s]||(e[s]=[]),e[s].push(l),e},{});return(0,t.jsxs)("div",{ref:e,className:"bg-gray-100 h-screen flex flex-col transition-all ".concat(r?"w-16":"w-48"),children:[(0,t.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[m&&(0,t.jsx)("div",{className:"text-xl font-bold",children:"个人助手"}),(0,t.jsx)(o.Ay,{type:"text",icon:r?(0,t.jsx)(j.A,{}):(0,t.jsx)(g.A,{}),onClick:()=>d(!r),className:"flex items-center justify-center"})]}),(0,t.jsx)("ul",{className:"flex-1 overflow-y-auto",children:Object.entries(f).map(e=>{let[l,s]=e;return(0,t.jsxs)("div",{children:[m&&!r&&(0,t.jsx)("div",{className:"text-xs text-gray-500 py-2 px-4 font-medium",children:l}),s.map(e=>(0,t.jsx)("li",{children:(0,t.jsxs)(i(),{href:e.path,className:"flex items-center py-2 transition-colors justify-center ".concat(r?"":"pr-4"," ").concat(x(e.path)?"bg-blue-500 text-white":"hover:bg-gray-200"),children:[(0,t.jsx)("span",{className:"text-lg",children:e.icon}),m&&(0,t.jsx)("span",{className:"ml-2",children:e.title})]})},e.key))]},l)})}),(0,t.jsx)("div",{className:"border-t border-gray-200 mt-auto",children:!r&&(0,t.jsx)(y.M,{})})]})}},36932:(e,l,s)=>{"use strict";s.r(l),s.d(l,{default:()=>k});var t=s(54568),a=s(7620),r=s(89223),i=s(62942),n=s(75019),c=s(14033),o=s(19764),d=s(85295),u=s(54458),h=s(29565),x=s(28059);let m={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"};var f=s(64607),v=a.forwardRef(function(e,l){return a.createElement(f.default,(0,x.A)({},e,{ref:l,icon:m}))});let p={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M136 552h63.6c4.4 0 8-3.6 8-8V288.7h528.6v72.6c0 1.9.6 3.7 1.8 5.2a8.3 8.3 0 0011.7 1.4L893 255.4c4.3-5 3.6-10.3 0-13.2L749.7 129.8a8.22 8.22 0 00-5.2-1.8c-4.6 0-8.4 3.8-8.4 8.4V209H199.7c-39.5 0-71.7 32.2-71.7 71.8V544c0 4.4 3.6 8 8 8zm752-80h-63.6c-4.4 0-8 3.6-8 8v255.3H287.8v-72.6c0-1.9-.6-3.7-1.8-5.2a8.3 8.3 0 00-11.7-1.4L131 768.6c-4.3 5-3.6 10.3 0 13.2l143.3 112.4c1.5 1.2 3.3 1.8 5.2 1.8 4.6 0 8.4-3.8 8.4-8.4V815h536.6c39.5 0 71.7-32.2 71.7-71.8V480c-.2-4.4-3.8-8-8.2-8z"}}]},name:"retweet",theme:"outlined"};var j=a.forwardRef(function(e,l){return a.createElement(f.default,(0,x.A)({},e,{ref:l,icon:p}))});let g={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-.7 5.2-2L869 536.2a32.07 32.07 0 000-48.4z"}}]},name:"arrow-right",theme:"outlined"};var y=a.forwardRef(function(e,l){return a.createElement(f.default,(0,x.A)({},e,{ref:l,icon:g}))}),A=s(70441),w=s(7811);let b=()=>{var e;let{data:l,status:s}=(0,r.useSession)(),h=(0,i.useRouter)(),x=(0,i.useSearchParams)().get("callbackUrl")||"/",m=(0,a.useMemo)(()=>{var e;if("authenticated"!==s||!x||"/"===x)return!1;let t=w.W.find(e=>x.startsWith(e.path.split("/").slice(0,2).join("/")));if(!(null==t?void 0:t.allowedRoles)||0===t.allowedRoles.length)return!0;let a=(null==l?void 0:null===(e=l.user)||void 0===e?void 0:e.role)||"";return!!t.allowedRoles.includes(a)},[l,s,x]),f=async()=>{await (0,r.signOut)({callbackUrl:"/auth/signin"})};return(0,t.jsx)("div",{className:"flex min-h-screen flex-col items-center justify-center p-6 bg-gray-100",children:(0,t.jsx)(n.A,{className:"w-full max-w-lg shadow-lg",children:(0,t.jsx)(c.Ay,{status:"403",title:"访问受限",icon:(0,t.jsx)(v,{style:{color:"#f5222d"}}),subTitle:(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsxs)(o.A.Paragraph,{children:["很抱歉，您的账号 ",(0,t.jsx)("strong",{children:null==l?void 0:null===(e=l.user)||void 0===e?void 0:e.email})," 没有权限访问此功能。"]}),(0,t.jsx)(o.A.Paragraph,{children:"需要特定邮箱账号才能访问某些功能。如果您认为这是一个错误，请联系管理员申请权限。"})]}),extra:(0,t.jsxs)(d.A,{children:[m?(0,t.jsx)(u.Ay,{type:"primary",icon:(0,t.jsx)(j,{}),onClick:()=>h.push(x),children:"重试"}):(0,t.jsx)(u.Ay,{type:"primary",icon:(0,t.jsx)(y,{}),onClick:()=>h.push("/"),children:"回到首页"}),(0,t.jsx)(u.Ay,{type:"primary",danger:!0,icon:(0,t.jsx)(A.A,{}),onClick:f,children:"切换账号"})]})})})})},k=()=>(0,t.jsx)(a.Suspense,{fallback:(0,t.jsx)(h.A,{}),children:(0,t.jsx)(b,{})})},46246:(e,l,s)=>{"use strict";s.d(l,{M:()=>x});var t=s(54568);s(7620);var a=s(50585),r=s(54458),i=s(55527),n=s(85295),c=s(6933),o=s(89223),d=s(33876),u=s(70441),h=s(83439);let x=()=>{var e,l,s,x,m;let{data:f,status:v}=(0,o.useSession)(),p=async()=>{try{await (0,o.signIn)("google")}catch(e){console.error("登录失败:",e),a.Ay.error("登录失败，请稍后重试")}},j=async()=>{try{await (0,o.signOut)({callbackUrl:"/"})}catch(e){console.error("退出登录失败:",e),a.Ay.error("退出登录失败，请稍后重试")}};if("loading"===v)return(0,t.jsx)("div",{className:"flex items-center justify-center p-2",children:(0,t.jsx)("span",{className:"text-gray-400 text-sm",children:"加载中..."})});if("unauthenticated"===v)return(0,t.jsx)("div",{className:"p-2",children:(0,t.jsx)(r.Ay,{type:"text",icon:(0,t.jsx)(d.A,{}),onClick:p,size:"small",className:"flex items-center w-full",children:(0,t.jsx)("span",{className:"ml-1",children:"登录"})})});let g=[{key:"profile",label:(0,t.jsxs)("div",{className:"p-2",children:[(0,t.jsx)("div",{className:"font-medium",children:null==f?void 0:null===(e=f.user)||void 0===e?void 0:e.name}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:null==f?void 0:null===(l=f.user)||void 0===l?void 0:l.email})]})},{key:"logout",label:"退出登录",icon:(0,t.jsx)(u.A,{}),onClick:()=>{j()}}];return(0,t.jsx)("div",{className:"p-2",children:(0,t.jsx)(i.A,{menu:{items:g},placement:"topLeft",children:(0,t.jsxs)(n.A,{className:"cursor-pointer w-full flex items-center",children:[(0,t.jsx)(c.A,{size:"small",src:(null==f?void 0:null===(s=f.user)||void 0===s?void 0:s.image)||void 0,icon:(null==f?void 0:null===(x=f.user)||void 0===x?void 0:x.image)?void 0:(0,t.jsx)(h.A,{})}),(0,t.jsx)("span",{className:"text-sm text-ellipsis overflow-hidden",children:null==f?void 0:null===(m=f.user)||void 0===m?void 0:m.name})]})})})}},82140:(e,l,s)=>{Promise.resolve().then(s.bind(s,36932))}},e=>{var l=l=>e(e.s=l);e.O(0,[2998,6502,5888,4030,794,9223,4033,9565,2983,3651,587,8315,7358],()=>l(82140)),_N_E=e.O()}]);