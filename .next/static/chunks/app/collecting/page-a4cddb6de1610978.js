(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7781],{13414:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>T});var l=s(54568),r=s(7620),n=s(53979),i=s(75019),a=s(19832),o=s(85295);let d=e=>{let{tags:t,value:s,onChange:r}=e;return 0===t.length?null:(0,l.jsx)(i.A,{size:"small",style:{marginBottom:16},children:(0,l.jsx)(a.A.Group,{value:s,onChange:r,children:(0,l.jsx)(o.A,{wrap:!0,children:t.map(e=>(0,l.jsx)(a.A,{value:e,children:e},e))})})})};var u=s(45447),c=s(92211),p=s(20667);let m=e=>{let{item:t,type:s=t.type,onSuccess:i}=e,[a]=n.lVW.useForm(),[o,d]=(0,r.useState)(!1),{createState:m,updateState:y}=(0,p.wm)({list:!1}),x=!!t,g=x?t.type:s,h=async()=>{let e=await a.validateFields();x?await y.mutateAsync(t.id,e):await m.mutateAsync(e),d(!1),a.resetFields(),i()},j=[{title:"类型",dataIndex:"type",valueType:"select",valueEnum:{[c.CollectingType.Url]:{text:"网址"},[c.CollectingType.Prompt]:{text:"提示词"},[c.CollectingType.Copy]:{text:"文案"}},fieldProps:{disabled:!!g},formItemProps:{rules:[{required:!0,message:"请选择类型"}]}},{title:"标题",dataIndex:"title",valueType:"text",formItemProps:{rules:[{required:!0,message:"请输入标题"}]}},{title:"描述",dataIndex:"description",valueType:"textarea",fieldProps:{rows:2}},{title:"内容",dataIndex:"content",valueType:"textarea",fieldProps:{rows:4},formItemProps:{rules:[{required:!0,message:"请输入内容"}]}},{title:"标签",dataIndex:"tags",valueType:"select",fieldProps:{mode:"tags",placeholder:"输入标签后按回车"},formItemProps:{rules:[{required:!0,message:"请添加至少一个标签"}]}},...s!==c.CollectingType.Prompt?[]:[{title:"示例",dataIndex:"images",renderFormItem:()=>(0,l.jsx)(n.tuV,{})}]];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.$nd,{type:x?"text":"primary",icon:x?(0,l.jsx)(n.xjh,{}):(0,l.jsx)(n.bW0,{}),onClick:()=>{x?a.setFieldsValue(u._.omit(t,["id"])):a.setFieldsValue({type:g}),d(!0)}}),(0,l.jsx)(n.aFV,{title:x?"编辑资料":"添加资料",open:o,onCancel:()=>{d(!1),a.resetFields()},onOk:h,children:(0,l.jsx)(n.kyL,{layoutType:"Form",form:a,columns:j,submitter:!1,layout:"horizontal",labelCol:{span:4},initialValues:{type:g}})})]})},y=e=>{let{id:t,onSuccess:s}=e,{removeState:r}=(0,p.wm)({list:!1,remove:{onSuccess:s}});return(0,l.jsx)(n.$nd,{type:"text",danger:!0,icon:(0,l.jsx)(n.SUY,{}),onClick:()=>r.mutate(t)})},x=e=>{let{items:t,onRefresh:s}=e;return 0===t.length?(0,l.jsx)(n.SvL,{description:"暂无数据"}):(0,l.jsx)(n.fI1,{gutter:10,children:t.map(e=>{var t;return(0,l.jsx)(n.fvL,{xs:24,sm:12,md:8,lg:6,children:(0,l.jsxs)(n.ZpM,{title:e.title,size:"small",styles:{body:{padding:0}},extra:(0,l.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,l.jsx)(m,{item:e,onSuccess:s}),(0,l.jsx)(y,{id:e.id,onSuccess:s})]}),actions:[(0,l.jsx)("div",{children:e.tags.map(e=>(0,l.jsx)(n.vwO,{children:e},e))},"tags")],children:[(0,l.jsx)("div",{style:{height:200,overflow:"hidden"},children:(0,l.jsx)(n.FNf,{arrows:!0,children:null===(t=e.images)||void 0===t?void 0:t.map((e,t)=>(0,l.jsx)(n._V3,{alt:"",preview:!1,src:e,style:{objectFit:"cover"}},t))})}),(0,l.jsxs)("div",{className:"p-1",children:[e.description&&(0,l.jsx)(n.o5u.Paragraph,{type:"secondary",ellipsis:{rows:2},style:{marginBottom:8},children:e.description}),(0,l.jsx)(n.o5u.Paragraph,{ellipsis:{rows:3},style:{marginBottom:8},children:e.content})]})]})},e.id)})})};var g=s(38993);let h=e=>{let{data:t=[],isLoading:s,refetch:l}=g.F.collecting.findMany.useQuery({where:{type:e}});return{collectingItems:(0,r.useMemo)(()=>t.map(e=>({...e,tags:Array.isArray(e.tags)?e.tags:[]})),[t]),loading:s,refetch:l}},j=e=>{let t=u._.flatten(e.map(e=>e.tags));return u._.uniq(t)},v=(e,t)=>t.length?e.filter(e=>t.every(t=>e.tags.includes(t))):e,f=e=>{let[t,s]=(0,r.useState)([]),l=(0,r.useMemo)(()=>j(e),[e]),n=(0,r.useMemo)(()=>v(e,t),[e,t]);return{tags:l,selectedTags:t,filteredItems:n,onChangeTag:e=>{s(e)}}},b=e=>{let{type:t}=e,{collectingItems:s,loading:r,refetch:i}=h(t),{tags:a,selectedTags:o,filteredItems:u,onChangeTag:c}=f(s);return(0,l.jsx)(n.tKH,{spinning:r,children:(0,l.jsxs)("div",{className:"w-full flex flex-col h-[83vh]",children:[(0,l.jsx)("div",{style:{position:"absolute",right:0,top:-62},children:(0,l.jsx)(m,{type:t,onSuccess:i})}),(0,l.jsx)(d,{tags:a,value:o,onChange:c}),(0,l.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,l.jsx)(x,{items:u,onRefresh:i})})]})})},C=[{key:c.CollectingType.Url,label:"网址"},{key:c.CollectingType.Prompt,label:"提示词"},{key:c.CollectingType.Copy,label:"文案"}],T=()=>{let[e,t]=(0,r.useState)(c.CollectingType.Url);return(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-3",children:"资料收集"}),(0,l.jsx)(n.tUM,{activeKey:e,onChange:e=>{t(e)},items:C.map(e=>({key:e.key,label:e.label,children:(0,l.jsx)(b,{type:e.key})}))})]})}},23537:(e,t,s)=>{Promise.resolve().then(s.bind(s,13414))},29392:(e,t,s)=>{"use strict";s.d(t,{_1:()=>n,b4:()=>l,lQ:()=>i,ln:()=>r});var l=function(e){return e.Minutes5="minutes5",e.Minutes10="minutes10",e.Minutes20="minutes20",e.Minutes30="minutes30",e.Hourly="hourly",e.Daily="daily",e.Weekly="weekly",e}({}),r=function(e){return e.Manual="manual",e.Scheduled="scheduled",e}({}),n=function(e){return e.MarkAsRead="markAsRead",e.MarkAsUnread="markAsUnread",e.Star="star",e.Unstar="unstar",e.OpenLink="openLink",e}({}),i=function(e){return e.Edit="edit",e.Delete="delete",e.Enable="enable",e.Disable="disable",e.Fetch="fetch",e}({})},92211:(e,t,s)=>{"use strict";s.d(t,{ButtonsType:()=>i,CollectingType:()=>a,HabitFrequencyType:()=>l,HabitProgressStatus:()=>r,HabitStatusMode:()=>n,RssFeedActionType:()=>o.lQ,RssFetchTriggerType:()=>o.ln,RssFrequency:()=>o.b4,RssItemActionType:()=>o._1});var l=function(e){return e.DAILY="DAILY",e.WEEKLY="WEEKLY",e.MONTHLY="MONTHLY",e}({}),r=function(e){return e.Disabled="disabled",e.Enabled="enabled",e.Pending="pending",e.Doing="doing",e.Done="done",e.Failed="failed",e}({}),n=function(e){return e.Habit="habit",e.Record="record",e}({});s(93657);var i=function(e){return e.Command="command",e.Copy="copy",e}({}),a=function(e){return e.Url="url",e.Prompt="prompt",e.Copy="copywriter",e}({}),o=s(29392)},93657:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[6854,6410,541,6771,2602,1598,1815,8259,1210,2998,6502,5888,4030,794,9223,4033,9565,2983,3651,1026,959,5229,5533,667,587,8315,7358],()=>t(23537)),_N_E=e.O()}]);