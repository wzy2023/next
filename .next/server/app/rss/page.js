(()=>{var e={};e.id=177,e.ids=[177],e.modules={1708:e=>{"use strict";e.exports=require("node:process")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5833:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(33952).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/wangzhenyu/Code/work/persons/app/src/app/rss/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/wangzhenyu/Code/work/persons/app/src/app/rss/page.tsx","default")},5835:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{_:()=>a._,f:()=>n.f});var a=r(42906),n=r(29973),i=e([a,n]);[a,n]=i.then?(await i)():i,s()}catch(e){s(e)}})},5871:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{G:()=>o});var a=r(13486);r(60159);var n=r(35412),i=r(74131),l=r(25448),c=r(17121),d=e([n,i,l]);[n,i,l]=d.then?(await d)():d;let o=(e,t)=>[{title:"标题",dataIndex:"title",width:"15%",ellipsis:!0,render:(e,t)=>(0,a.jsx)(l.E,{record:t})},{title:"内容",dataIndex:"summary",render:(e,r)=>{let s=r.content?.includes("<img"),i=(0,a.jsx)("div",{className:"max-w-lg max-h-96 overflow-auto",dangerouslySetInnerHTML:{__html:r.content||""}});return(0,a.jsxs)(n.AMh,{content:i,trigger:"hover",placement:"right",overlayClassName:"rss-content-popover",children:[(0,a.jsx)("div",{className:"px-1 max-h-40 overflow-auto",onDoubleClick:()=>{t&&r.id&&t(r.id,!r.isRead)},children:(0,a.jsx)("span",{dangerouslySetInnerHTML:{__html:r.summary||r.title||""}})}),s&&(0,a.jsx)(n.vwO,{children:"是"})]})}},{title:"来源及标签",key:"feedInfo",width:180,render:(e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:(0,a.jsx)(n.vwO,{children:t.feed?.name})}),(0,a.jsx)("div",{className:"mt-1",children:(t.feed?.tags||[]).map(e=>(0,a.jsx)(n.vwO,{children:e},e))})]})},{title:"AI 标签",dataIndex:"tags",width:150,render:(e,t)=>{let r=t.tags||[];return(0,a.jsx)(a.Fragment,{children:Array.isArray(r)&&r.map(e=>(0,a.jsx)(n.vwO,{children:e},e))})}},{title:"发布时间",dataIndex:"pubDate",width:180,render:e=>(0,c.yf)(e).format("YYYY-MM-DD HH:mm")},{title:"操作",key:"action",width:120,render:(t,r)=>(0,a.jsx)(i.J,{record:r,onAction:e})}];s()}catch(e){s(e)}})},6505:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{o:()=>l});var a=r(13486);r(60159);var n=r(35412),i=e([n]);n=(i.then?(await i)():i)[0];let l=e=>{let{selectedRowKeys:t,onBatchDelete:r,onBatchEnable:s,onBatchDisable:i}=e;return(0,a.jsx)(n.msM,{menu:{items:[{key:"delete",label:"批量删除",onClick:r},{key:"enable",label:"批量启用",onClick:s},{key:"disable",label:"批量禁用",onClick:i}]},disabled:0===t.length,children:(0,a.jsxs)(n.$nd,{children:["批量操作 ",(0,a.jsx)(n.lHd,{})]})})};s()}catch(e){s(e)}})},7273:e=>{"use strict";e.exports=require("prettier/parser-typescript")},8876:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{G:()=>c});var a=r(13486),n=r(35412),i=r(92064),l=e([n]);n=(l.then?(await l)():l)[0];let c=()=>[{title:"RSS源",dataIndex:["feed","name"],key:"feedName",width:300,render:(e,t)=>t.feed?.name?(0,a.jsx)(n.vwO,{children:t.feed.name}):(0,a.jsx)(n.vwO,{children:"未知"})},{title:"执行时间",dataIndex:"executedAt",key:"executedAt",valueType:"dateTime"},{title:"状态",dataIndex:"status",key:"status",valueEnum:{success:{text:"成功",status:"Success"},error:{text:"失败",status:"Error"}}},{title:"触发方式",dataIndex:"triggerType",width:100,render:(e,t)=>(0,a.jsx)(n.vwO,{color:t.triggerType===i.RssFetchTriggerType.Manual?"blue":"green",children:t.triggerType===i.RssFetchTriggerType.Manual?"手动":"定时"})},{title:"新增内容",dataIndex:"itemCount",key:"itemCount"},{title:"错误信息",dataIndex:"errorMessage",key:"errorMessage",ellipsis:!0}];s()}catch(e){s(e)}})},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14366:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{h:()=>y});var a=r(13486),n=r(60159),i=r(35412),l=r(78610),c=r(6505),d=r(74481),o=r(37802),u=r(5835),h=r(92064),p=e([i,l,c,d,o,u]);[i,l,c,d,o,u]=p.then?(await p)():p;let m=(e,t,r)=>{let s="",a=t?.reduce((e,t)=>e+t.newItemCount,0)||0;return s+=t.length?`抓取成功的订阅源 (${t.length})
`:"",t.forEach(e=>{s+=e.newItemCount?`	${e.name} (${e.newItemCount})
`:""}),s+=r.length?`
抓取失败的订阅源 (${r.length})
`:"",r.forEach(e=>{s+=`	${e.name} (${e.error})
`}),{title:`订阅源 (${e}) 个、新数据 (${a}) 条`,description:s}},y=()=>{let[e,t]=(0,n.useState)([]),[r,s]=(0,n.useState)(),[p,y]=(0,n.useState)(!1),[x,g]=(0,n.useState)(null),f=(0,n.useRef)(null),{feeds:v,isLoading:b,createFeed:j,updateFeed:S,deleteFeed:w,batchDeleteFeeds:k,batchUpdateFeeds:R,refetch:T}=(0,u._)(),A=d.F.custom.rssFeed.batchFetchNow.useMutation(),C=d.F.custom.rssFeed.getCountByFeed.useQuery();(0,n.useEffect)(()=>{if(r){let e=v?.find(e=>e.id===r);e&&(g(e),y(!0))}},[r,v]);let[I,O]=(0,n.useState)(!1),F=async e=>{let t=await A.mutateAsync({ids:[e],triggerType:h.RssFetchTriggerType.Manual});t.successFeeds?.length?i.iUO.success(`抓取完成：${t.successFeeds[0]?.newItemCount} 条新内容`):i.iUO.error(`抓取失败：${t.failedFeeds?.[0]?.error}`),T()},M=async()=>{try{O(!0);let{successFeeds:e=[],failedFeeds:t=[]}=await A.mutateAsync({triggerType:h.RssFetchTriggerType.Manual}),{title:r,description:s}=m(v.length,e,t);i.Ew_.success({message:r,description:(0,a.jsx)("div",{className:"whitespace-pre",children:s})}),T()}finally{O(!1)}},U=e=>{i.aFV.confirm({title:"确认删除",icon:(0,a.jsx)(i.G2i,{}),content:"删除后无法恢复，是否继续？",okText:"删除",okType:"danger",cancelText:"取消",onOk:async()=>{await w(e),i.iUO.success("删除成功"),f.current?.reload()}})},E=async(e,t)=>{await S(t,{enabled:e}),i.iUO.success(`${e?"启用":"禁用"}成功`),f.current?.reload()},D=r=>{if(0===e.length){i.iUO.warning("请选择要操作的项");return}let s=r?"启用":"禁用";i.aFV.confirm({title:`批量${s}`,content:`确定要${s}选中的 ${e.length} 项吗？`,onOk:async()=>{try{await R(e.map(e=>({id:e,data:{enabled:r}}))),i.iUO.success(`批量${s}成功`),t([]),f.current?.reload()}catch(e){console.error(`批量${s}失败:`,e),i.iUO.error(`批量${s}失败，请稍后重试`)}}})},q=async e=>{try{r?(await S(r,e),i.iUO.success("更新成功")):(await j(e),i.iUO.success("添加成功")),y(!1),s(void 0),g(null),f.current?.reload()}catch(e){console.error("提交失败:",e),i.iUO.error("操作失败，请稍后重试")}},_=(0,o.G)({onAction:(e,t)=>{switch(e){case h.RssFeedActionType.Edit:s(t);break;case h.RssFeedActionType.Delete:U(t);break;case h.RssFeedActionType.Fetch:F(t)}},onEnabledChange:E,getItemCount:e=>{if(!C.data)return 0;let t=C.data.find(t=>t.feedId===e);return t?t.count:0}});return(0,a.jsxs)("div",{className:"rss-feed-table",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,a.jsx)(i.$nd,{type:"primary",icon:(0,a.jsx)(i.bW0,{}),onClick:()=>{s(void 0),y(!0)},children:"添加订阅"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.$nd,{icon:(0,a.jsx)(i.OmY,{spin:I}),onClick:M,loading:I,children:"全部抓取"}),(0,a.jsx)(c.o,{selectedRowKeys:e,onBatchDelete:()=>{if(0===e.length){i.iUO.warning("请选择要删除的项");return}i.aFV.confirm({title:"批量删除",icon:(0,a.jsx)(i.G2i,{}),content:`确定要删除选中的 ${e.length} 项吗？`,okText:"删除",okType:"danger",cancelText:"取消",onOk:async()=>{await k(e),i.iUO.success("批量删除成功"),t([]),f.current?.reload()}})},onBatchEnable:()=>{D(!0)},onBatchDisable:()=>{D(!1)}})]})]}),(0,a.jsx)(i.iAN,{actionRef:f,rowKey:"id",columns:_,dataSource:v,loading:b,search:!1,options:!1,rowSelection:{selectedRowKeys:e,onChange:e=>{t(e.map(e=>String(e)))}},pagination:{showSizeChanger:!0,pageSizeOptions:["10","20","50"],defaultPageSize:15}}),(0,a.jsx)(l.R,{visible:p,currentId:r,record:x,onCancel:()=>{y(!1),s(void 0),g(null)},onSubmit:q})]})};s()}catch(e){s(e)}})},15738:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{b:()=>l});var a=r(13486);r(60159);var n=r(35412),i=e([n]);n=(i.then?(await i)():i)[0];let l=({record:e,onChange:t})=>(0,a.jsx)(n.dOG,{checked:e.enabled,onChange:r=>t(r,e.id)});s()}catch(e){s(e)}})},15931:(e,t,r)=>{Promise.resolve().then(r.bind(r,5833))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},23228:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>o,routeModule:()=>h,tree:()=>d});var s=r(24332),a=r(48819),n=r(67851),i=r.n(n),l=r(97540),c={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);r.d(t,c);let d={children:["",{children:["rss",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5833)),"/Users/wangzhenyu/Code/work/persons/app/src/app/rss/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,85631)),"/Users/wangzhenyu/Code/work/persons/app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,19033,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,39956,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,92341,23)),"next/dist/client/components/unauthorized-error"]}]}.children,o=["/Users/wangzhenyu/Code/work/persons/app/src/app/rss/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/rss/page",pathname:"/rss",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},25448:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{E:()=>c});var a=r(13486);r(60159);var n=r(35412),i=r(67785),l=e([n]);n=(l.then?(await l)():l)[0];let c=({record:e})=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"mr-2 flex-none",children:e.isRead?(0,a.jsx)(n.yKX,{style:{color:"#d9d9d9"}}):(0,a.jsx)(n.E6Q,{style:{color:"#1890ff"}})}),(0,a.jsx)("a",{href:(0,i.TU)(e.link),target:"_blank",rel:"noopener noreferrer",className:"flex-grow",children:e.title})]});s()}catch(e){s(e)}})},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29973:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{f:()=>c});var a=r(21543),n=r(1831),i=r.n(n),l=e([a]);a=(l.then?(await l)():l)[0];let c=(e={})=>{let{listState:t,updateState:r,apiUtils:s}=(0,a.Bf)({showTip:!1,list:{query:{where:{isDeleted:!1,...e.search?{OR:[{title:{contains:e.search}},{description:{contains:e.search}}]}:{},...e.feedIds?.length?{feedId:{in:e.feedIds}}:{},...e.tags?.length?{feed:{tags:{array_contains:e.tags}}}:{},...void 0!==e.isRead?{isRead:e.isRead}:{},...void 0!==e.isStarred?{isStarred:e.isStarred}:{},...e.pubDateStart||e.pubDateEnd?{pubDate:{...e.pubDateStart?{gte:i()(e.pubDateStart).startOf("day").toISOString()}:{},...e.pubDateEnd?{lte:i()(e.pubDateEnd).endOf("day").toISOString()}:{}}}:{}},orderBy:{pubDate:"desc"},include:{feed:{select:{id:!0,name:!0,tags:!0}}}}}});return{items:t.data,isLoading:t.isLoading,isError:t.isError,error:t.error,refetch:t.refetch,toggleRead:(e,t)=>r.mutateAsync(e,{isRead:t}),toggleStar:(e,t)=>r.mutateAsync(e,{isStarred:t}),batchToggleRead:(e,t)=>{let s=e.map(e=>r.mutateAsync(e,{isRead:t}));return Promise.all(s)},apiUtils:s}};s()}catch(e){s(e)}})},33873:e=>{"use strict";e.exports=require("path")},34500:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{V:()=>d});var a=r(13486);r(60159);var n=r(35412),i=r(8876),l=r(21543),c=e([n,i,l]);[n,i,l]=c.then?(await c)():c;let d=()=>{let{listState:e}=(0,l.EG)({list:{query:{where:{itemCount:{gt:0}},orderBy:{executedAt:"desc"},include:{feed:{select:{name:!0}}}}}});return(0,a.jsx)(n.iAN,{rowKey:"id",headerTitle:"抓取日志",search:!1,options:!1,dataSource:e.data,loading:e.isLoading,columns:(0,i.G)(),pagination:{showSizeChanger:!0,pageSizeOptions:["10","20","50"],defaultPageSize:10}})};s()}catch(e){s(e)}})},34589:e=>{"use strict";e.exports=require("node:assert")},37802:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{G:()=>o});var a=r(13486),n=r(35412),i=r(84063),l=r(15738),c=r(87638),d=e([n,i,l]);[n,i,l]=d.then?(await d)():d;let o=({onAction:e,onEnabledChange:t,getItemCount:r})=>[{title:"名称",dataIndex:"name"},{title:"RSS链接",dataIndex:"url",render:e=>(0,a.jsx)("a",{href:"http://localhost:1200"+e,target:"_blank",rel:"noopener noreferrer",children:e})},{title:"标签",dataIndex:"tags",key:"tags",render:e=>(0,a.jsx)(a.Fragment,{children:(e||[]).map(e=>(0,a.jsx)(n.vwO,{children:e},e))})},{title:"频率",dataIndex:"frequency",key:"frequency",render:e=>{let t=c.Df.find(t=>t.value===e);return t?t.label:e}},{title:"文章数",key:"itemCount",render:(e,t)=>r(t.id)},{title:"启用",dataIndex:"enabled",key:"enabled",render:(e,r)=>(0,a.jsx)(l.b,{record:r,onChange:t})},{title:"操作",key:"action",render:(t,r)=>(0,a.jsx)(i.y,{record:r,onAction:e})}];s()}catch(e){s(e)}})},38795:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>d});var a=r(13486),n=r(60159),i=r(35412),l=r(77593),c=e([i,l]);function d(){let[e,t]=(0,n.useState)("feeds");return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-3",children:"RSS信息抓取工具"}),(0,a.jsx)(i.tUM,{activeKey:e,onChange:e=>{t(e)},destroyInactiveTabPane:!0,items:[{key:"feeds",label:"RSS订阅管理",children:(0,a.jsx)(l.hX,{})},{key:"items",label:"RSS内容列表",children:(0,a.jsx)(l.c6,{})},{key:"logs",label:"抓取日志",children:(0,a.jsx)(l.VR,{})}]})]})}[i,l]=c.then?(await c)():c,s()}catch(e){s(e)}})},42906:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{_:()=>i});var a=r(21543),n=e([a]);a=(n.then?(await n)():n)[0];let i=()=>{let{listState:e,createState:t,updateState:r,removeState:s,apiUtils:n}=(0,a.K0)({showTip:!1,list:{query:{where:{isDeleted:!1},orderBy:{createdAt:"desc"}}}});return{feeds:e.data,isLoading:e.isLoading,isError:e.isError,error:e.error,refetch:e.refetch,createFeed:e=>t.mutateAsync(e),updateFeed:(e,t)=>r.mutateAsync(e,t),deleteFeed:e=>s.mutateAsync(e),batchDeleteFeeds:e=>{let t=e.map(e=>s.mutateAsync(e));return Promise.all(t)},batchUpdateFeeds:e=>{let t=Object.values(e).map(e=>{r.mutateAsync(e.id,e.data)});return Promise.all(t)},apiUtils:n}};s()}catch(e){s(e)}})},51455:e=>{"use strict";e.exports=require("node:fs/promises")},57975:e=>{"use strict";e.exports=require("node:util")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},67785:(e,t,r)=>{"use strict";r.d(t,{M1:()=>n,TU:()=>s,Uz:()=>a});let s=e=>e&&!/^https?:\/\//.exec(e)?"http://"+e:e,a=e=>{let t,r;return e.pubDate?.length===2&&([t,r]=e.pubDate),{search:e.search||"",feedIds:e.feedIds||[],tags:e.tags||[],isRead:e.isRead,isStarred:e.isStarred,pubDateStart:t,pubDateEnd:r}},n=e=>{let t=new Set;return e?.forEach(e=>{e.tags&&Array.isArray(e.tags)&&e.tags.forEach(e=>t.add(e))}),Array.from(t).map(e=>({label:e,value:e}))}},73024:e=>{"use strict";e.exports=require("node:fs")},73136:e=>{"use strict";e.exports=require("node:url")},74131:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{J:()=>c});var a=r(13486);r(60159);var n=r(35412),i=r(92064),l=e([n]);n=(l.then?(await l)():l)[0];let c=e=>{let{record:t,onAction:r}=e;return(0,a.jsxs)(n.$xS,{size:"middle",children:[(0,a.jsx)(n.m_M,{title:t.isRead?"标记为未读":"标记为已读",children:(0,a.jsx)("a",{onClick:()=>{let e=t.isRead?i.RssItemActionType.MarkAsUnread:i.RssItemActionType.MarkAsRead;r(e,t.id)},children:t.isRead?(0,a.jsx)(n.yKX,{style:{color:"#d9d9d9"}}):(0,a.jsx)(n.E6Q,{style:{color:"#1890ff"}})})}),(0,a.jsx)(n.m_M,{title:t.isStarred?"取消收藏":"收藏",children:(0,a.jsx)("a",{onClick:()=>{let e=t.isStarred?i.RssItemActionType.Unstar:i.RssItemActionType.Star;r(e,t.id)},children:t.isStarred?(0,a.jsx)(n.BQ2,{style:{color:"#faad14"}}):(0,a.jsx)(n.L0Y,{})})}),(0,a.jsx)(n.m_M,{title:t.isSent?"已发送":"未发送",children:t.isSent?(0,a.jsx)(n.QIx,{style:{color:"#faad14"}}):(0,a.jsx)(n.g1U,{})})]})};s()}catch(e){s(e)}})},76019:(e,t,r)=>{Promise.resolve().then(r.bind(r,38795))},76760:e=>{"use strict";e.exports=require("node:path")},76830:e=>{"use strict";e.exports=require("prettier/parser-babel")},77442:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{B:()=>u});var a=r(13486),n=r(60159),i=r(35412),l=e([i]);i=(l.then?(await l)():l)[0];let d=[{value:"jike",label:"即刻",children:[{value:"user",label:"用户"},{value:"topic",label:"圈子"}]}],o={jike:{user:"/jike/user/{value}",topic:"/jike/topic/{value}"}};var c=function(e){return e.CUSTOM="custom",e.SELECT="select",e.BATCH="batch",e}(c||{});let u=e=>{let{currentId:t,value:r,onChange:s,onBatchChange:l}=e,[c,u]=(0,n.useState)("custom"),[h,p]=(0,n.useState)(""),[m,y]=(0,n.useState)([]),[x,g]=(0,n.useState)(""),[f,v]=(0,n.useState)(""),[b,j]=(0,n.useState)("");(0,n.useEffect)(()=>{r&&p(r)},[]),(0,n.useEffect)(()=>{r&&"select"===c&&p(r)},[r,c]),(0,n.useEffect)(()=>{"custom"===c&&s&&s(h)},[h,c,s]),(0,n.useEffect)(()=>{"select"===c&&b&&s&&s(b)},[b,c,s]),(0,n.useEffect)(()=>{if("batch"===c&&s){let e=S(f);e.length>0?s(e[0]||""):s("")}},[f,c,s]);let S=e=>e?e.split("\n").map(e=>e.trim()).filter(e=>e&&e.length>0):[],w=()=>{if(2!==m.length)return"";if(x){let[e,t]=m,r=o[e]?.[t];if(r){let e=r.replace("{value}",x);return j(e),e}}return j(""),""};return(0,a.jsx)(i.tUM,{size:"small",activeKey:c,onChange:e=>u(e),items:[{key:"custom",label:"自定义",children:(0,a.jsx)(i.pde,{placeholder:"请输入RSS链接",value:h,onChange:e=>p(e.target.value)})},{key:"select",label:"选择",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)(i.$xS,{style:{width:"100%"},children:[(0,a.jsx)(i.vxQ,{options:d,placeholder:"选择平台和渠道",onChange:e=>{y(e),j("")}}),(0,a.jsx)(i.pde,{placeholder:"请输入值",value:x,onChange:e=>{g(e.target.value)},onBlur:()=>{w()},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),w())},disabled:2!==m.length})]}),b&&(0,a.jsx)("div",{style:{marginTop:8,color:"#666"},children:b})]})},...t?[]:[{key:"batch",label:"批量",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(i.pde.TextArea,{placeholder:"请输入多个RSS链接，每行一个",value:f,onChange:e=>{let t=e.target.value;if(v(t),l){let e=S(t);l(e)}},autoSize:{minRows:3,maxRows:10}}),(0,a.jsxs)("div",{style:{marginTop:8,fontSize:"12px",color:"#666"},children:["已识别 ",S(f).length," 个链接"]})]})}]]})};s()}catch(e){s(e)}})},77593:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{VR:()=>i.V,c6:()=>a.c,hX:()=>n.h});var a=r(96441),n=r(14366),i=r(34500),l=e([a,n,i]);[a,n,i]=l.then?(await l)():l,s()}catch(e){s(e)}})},78610:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{R:()=>p});var a=r(13486),n=r(60159),i=r(35412),l=r(77442),c=r(5835),d=r(87638),o=r(67785),u=r(92064),h=e([i,l,c]);[i,l,c]=h.then?(await h)():h;let p=e=>{let{visible:t,currentId:r,record:s,onCancel:h,onSubmit:p}=e,[m]=i.lVW.useForm(),[y,x]=(0,n.useState)([]),[g,f]=(0,n.useState)(!1),{feeds:v,createFeed:b}=(0,c._)(),j=(0,o.M1)(v||[]);(0,n.useEffect)(()=>{t&&s?m.setFieldsValue({name:s.name,url:s.url,frequency:s.frequency,tags:s.tags||[]}):m.resetFields()},[t,s,m]);let S=async()=>{try{let e=await m.validateFields();g&&y.length>0?await w(e):await p(e),m.resetFields()}catch(e){console.error("表单验证失败:",e)}},w=async e=>{if(0===y.length){i.iUO.warning("请至少输入一个有效的RSS链接");return}try{let t={success:0,fail:0};for(let[r,s]of y.entries()){let[a,n]=s.split(" - ");i.iUO.loading(`正在批量添加 ${r} / ${y.length} 个RSS订阅...`,0);try{let r={name:`${e.name||""}${a||""}`,url:n,frequency:e.frequency,tags:e.tags||[]};await b(r),t.success++}catch(e){console.error(`添加RSS失败: ${n}`,e),t.fail++}}t.success>0&&i.iUO.success(`成功添加 ${t.success} 个RSS订阅`),t.fail>0&&i.iUO.error(`${t.fail} 个RSS订阅添加失败`),h()}catch(e){i.iUO.error("批量添加失败"),console.error("批量添加失败:",e)}};return(0,a.jsx)(i.aFV,{title:r?"编辑RSS订阅":"添加RSS订阅",open:t,onCancel:h,onOk:S,destroyOnClose:!0,children:(0,a.jsxs)(i.lVW,{form:m,layout:"vertical",initialValues:{frequency:u.RssFrequency.Minutes10},children:[(0,a.jsx)(i.lVW.Item,{name:"name",label:g?"名称前缀":"名称",rules:[{required:!g,message:"请输入RSS名称"}],children:(0,a.jsx)(i.pde,{placeholder:"请输入RSS名称"})}),(0,a.jsx)(i.lVW.Item,{name:"url",label:"RSS链接",rules:[{required:!g,message:"请输入RSS链接"}],children:(0,a.jsx)(l.B,{currentId:r,onBatchChange:e=>{x(e),f(e.length>0)}})}),g&&(0,a.jsxs)("div",{style:{marginBottom:16,padding:8,backgroundColor:"#f5f5f5",borderRadius:4},children:[(0,a.jsx)("div",{children:"批量模式说明:"}),(0,a.jsxs)("ul",{style:{marginLeft:20,marginBottom:0},children:[(0,a.jsxs)("li",{children:["识别到 ",y.length," 个链接"]}),(0,a.jsx)("li",{children:'名称将自动使用"输入名称 - 链接末尾标识"命名'}),(0,a.jsx)("li",{children:"所有链接将使用相同的抓取频率和标签"})]})]}),(0,a.jsx)(i.lVW.Item,{name:"frequency",label:"抓取频率",rules:[{required:!0,message:"请选择抓取频率"}],children:(0,a.jsx)(i.l6P,{placeholder:"请选择抓取频率",options:d.Df})}),(0,a.jsx)(i.lVW.Item,{name:"tags",label:"标签",children:(0,a.jsx)(i.l6P,{mode:"tags",placeholder:"请输入标签，按回车确认",options:j})})]})})};s()}catch(e){s(e)}})},78877:e=>{"use strict";e.exports=require("node:v8")},80842:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{K:()=>o});var a=r(13486);r(60159);var n=r(35412),i=r(67785),l=r(87638),c=r(74481),d=e([n,c]);[n,c]=d.then?(await d)():d;let o=e=>{let{form:t,feeds:r,onSearch:s}=e,d=c.F.custom.rssItem.aiSummary.useMutation({onSuccess:e=>{n.iUO.success(e.message)}}),o=c.F.custom.rssItem.markAllAsRead.useMutation({onSuccess:()=>{s(t.getFieldsValue())}}),u=(0,i.M1)(r);return(0,a.jsxs)(n.lVW,{form:t,layout:"inline",onFinish:e=>{s(e)},children:[(0,a.jsx)(n.lVW.Item,{name:"search",children:(0,a.jsx)(n.pde,{placeholder:"搜索标题或内容",allowClear:!0})}),(0,a.jsx)(n.lVW.Item,{name:"tags",children:(0,a.jsx)(n.l6P,{placeholder:"选择来源标签",options:u,mode:"multiple",allowClear:!0,style:{width:120}})}),(0,a.jsx)(n.lVW.Item,{name:"isRead",children:(0,a.jsx)(n.sxL.Group,{options:l.je,optionType:"button",buttonStyle:"solid"})}),(0,a.jsx)(n.lVW.Item,{name:"isStarred",children:(0,a.jsx)(n.sxL.Group,{options:l.kN,optionType:"button",buttonStyle:"solid"})}),(0,a.jsxs)(n.lVW.Item,{children:[(0,a.jsx)(n.$nd,{type:"primary",htmlType:"submit",children:"搜索"}),(0,a.jsx)(n.$nd,{style:{marginLeft:8},onClick:()=>{t.resetFields(),setTimeout(()=>{s(t.getFieldsValue())},0)},children:"重置"}),(0,a.jsx)(n.$nd,{style:{marginLeft:8},onClick:()=>d.mutate(),loading:d.isPending,children:"AI 摘要"}),(0,a.jsx)(n.$nd,{style:{marginLeft:8},onClick:()=>o.mutate(),loading:o.isPending,children:"全部标为已读"})]})]})};s()}catch(e){s(e)}})},83505:e=>{"use strict";e.exports=import("prettier/standalone")},84063:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{y:()=>d});var a=r(13486),n=r(60159),i=r(35412),l=r(92064),c=e([i]);i=(c.then?(await c)():c)[0];let d=e=>{let{record:t,onAction:r}=e,[s,c]=(0,n.useState)(!1);return(0,a.jsxs)(i.$xS,{size:"middle",children:[(0,a.jsx)(i.m_M,{title:"编辑",children:(0,a.jsx)("a",{onClick:()=>r(l.RssFeedActionType.Edit,t.id),children:(0,a.jsx)(i.xjh,{})})}),(0,a.jsx)(i.m_M,{title:"删除",children:(0,a.jsx)("a",{onClick:()=>r(l.RssFeedActionType.Delete,t.id),children:(0,a.jsx)(i.SUY,{})})}),(0,a.jsx)(i.m_M,{title:"立即抓取",children:(0,a.jsx)("a",{onClick:()=>{c(!0),r(l.RssFeedActionType.Fetch,t.id),setTimeout(()=>c(!1),1e4)},children:(0,a.jsx)(i.OmY,{spin:s})})})]})};s()}catch(e){s(e)}})},87638:(e,t,r)=>{"use strict";r.d(t,{Df:()=>a,je:()=>n,kN:()=>i});var s=r(96602);let a=[{label:"每5分钟",value:s.b4.Minutes5},{label:"每10分钟",value:s.b4.Minutes10},{label:"每20分钟",value:s.b4.Minutes20},{label:"每30分钟",value:s.b4.Minutes30},{label:"每小时",value:s.b4.Hourly},{label:"每天",value:s.b4.Daily},{label:"每周",value:s.b4.Weekly}],n=[{label:"全部",value:void 0},{label:"已读",value:!0},{label:"未读",value:!1}],i=[{label:"全部",value:void 0},{label:"已收藏",value:!0},{label:"未收藏",value:!1}]},89116:e=>{"use strict";e.exports=require("vscode-oniguruma")},92064:(e,t,r)=>{"use strict";r.d(t,{ButtonsType:()=>i,CollectingType:()=>l,HabitFrequencyType:()=>s,HabitProgressStatus:()=>a,HabitStatusMode:()=>n,RssFeedActionType:()=>c.lQ,RssFetchTriggerType:()=>c.ln,RssFrequency:()=>c.b4,RssItemActionType:()=>c._1});var s=function(e){return e.DAILY="DAILY",e.WEEKLY="WEEKLY",e.MONTHLY="MONTHLY",e}({}),a=function(e){return e.Disabled="disabled",e.Enabled="enabled",e.Pending="pending",e.Doing="doing",e.Done="done",e.Failed="failed",e}({}),n=function(e){return e.Habit="habit",e.Record="record",e}({});r(95985);var i=function(e){return e.Command="command",e.Copy="copy",e}({}),l=function(e){return e.Url="url",e.Prompt="prompt",e.Copy="copywriter",e}({}),c=r(96602)},95985:()=>{},96441:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{c:()=>p});var a=r(13486),n=r(60159),i=r(35412),l=r(80842),c=r(5871),d=r(5835),o=r(67785),u=r(92064),h=e([i,l,c,d]);[i,l,c,d]=h.then?(await h)():h;let p=()=>{let[e,t]=(0,n.useState)({search:"",feedIds:[],tags:[],isRead:void 0,isStarred:void 0,pubDateStart:void 0,pubDateEnd:void 0}),{feeds:r}=(0,d._)(),{items:s,isLoading:h,refetch:p,toggleRead:m,toggleStar:y}=(0,d.f)(e),x=(0,n.useRef)(null),[g]=i.lVW.useForm(),f=async(e,t)=>{switch(e){case u.RssItemActionType.MarkAsRead:await m(t,!0),i.iUO.success("标记已读成功");break;case u.RssItemActionType.MarkAsUnread:await m(t,!1),i.iUO.success("标记未读成功");break;case u.RssItemActionType.Star:await y(t,!0),i.iUO.success("收藏成功");break;case u.RssItemActionType.Unstar:await y(t,!1),i.iUO.success("取消收藏成功")}await p(),x.current&&x.current.reload()},v=async(e,t)=>{await m(e,t),i.iUO.success(t?"标记已读成功":"标记未读成功"),await p(),x.current&&x.current.reload()},b=(0,c.G)(f,v);return(0,a.jsxs)("div",{className:"rss-item-table",children:[(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsx)(l.K,{form:g,feeds:r||[],onSearch:e=>{let r=(0,o.Uz)(e);t(r),p()}})}),(0,a.jsx)(i.iAN,{actionRef:x,rowKey:"id",columns:b,dataSource:s,loading:h,search:!1,options:!1,pagination:{showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],defaultPageSize:10},onRow:e=>({onDoubleClick:()=>{e.id&&v(e.id,!e.isRead)}})})]})};s()}catch(e){s(e)}})},96602:(e,t,r)=>{"use strict";r.d(t,{_1:()=>n,b4:()=>s,lQ:()=>i,ln:()=>a});var s=function(e){return e.Minutes5="minutes5",e.Minutes10="minutes10",e.Minutes20="minutes20",e.Minutes30="minutes30",e.Hourly="hourly",e.Daily="daily",e.Weekly="weekly",e}({}),a=function(e){return e.Manual="manual",e.Scheduled="scheduled",e}({}),n=function(e){return e.MarkAsRead="markAsRead",e.MarkAsUnread="markAsUnread",e.Star="star",e.Unstar="unstar",e.OpenLink="openLink",e}({}),i=function(e){return e.Edit="edit",e.Delete="delete",e.Enable="enable",e.Disable="disable",e.Fetch="fetch",e}({})},98995:e=>{"use strict";e.exports=require("node:module")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[734,661,206,571,543],()=>r(23228));module.exports=s})();