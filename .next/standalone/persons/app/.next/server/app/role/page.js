(()=>{var e={};e.id=959,e.ids=[959],e.modules={1708:e=>{"use strict";e.exports=require("node:process")},2051:(e,t,r)=>{"use strict";r.d(t,{vt:()=>u});var s=r(13050),n=r(60159),a=r(81816);let{useDebugValue:i}=n,{useSyncExternalStoreWithSelector:l}=a,o=!1,d=e=>e,c=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?(0,s.y)(e):e,r=(e,r)=>(function(e,t=d,r){r&&!o&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),o=!0);let s=l(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return i(s),s})(t,e,r);return Object.assign(r,t),r},u=e=>e?c(e):c},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5569:(e,t,r)=>{Promise.resolve().then(r.bind(r,28575))},7273:e=>{"use strict";e.exports=require("prettier/parser-typescript")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12375:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{X:()=>c});var n=r(13486);r(60159);var a=r(35412),i=r(70948),l=r(87778),o=r(21543),d=e([a,i,l,o]);[a,i,l,o]=d.then?(await d)():d;let c=e=>{let{list:t,onSuccess:r}=e,{updateState:s}=(0,o.wy)({list:!1,update:{onSuccess:r}}),{listState:d}=(0,o.sk)({list:{query:{where:{enabled:!0},orderBy:{createdAt:"desc"}}}}),c=e=>{let t=e,r=d.data||[];return e&&r.length>0&&(t=e.replace(/@([^\n@]+?)(?=\n|@|$)/g,(e,t)=>{let s=t.trim(),n=r.find(e=>e.title===s);return n&&n.content||e})),t},u=(e,t)=>{s.mutate(t.id,{enabled:e})},p=e=>{let t=c(e);navigator.clipboard.writeText(t),a.iUO.success("内容已复制")};return(0,n.jsx)(a.fI1,{gutter:[16,16],children:(t||[]).map(e=>(0,n.jsx)(a.fvL,{xs:24,md:12,lg:8,children:(0,n.jsxs)(a.ZpM,{size:"small",title:e.title,extra:(0,n.jsx)(a.dOG,{size:"small",checked:e.enabled,onChange:t=>u(t,e)}),actions:[(0,n.jsx)(a.$nd,{type:"text",icon:(0,n.jsx)(a.wq3,{}),onClick:()=>p(e.content),title:"复制内容"},"copy"),(0,n.jsx)(i.G,{initialValues:e,onSuccess:r},"edit"),(0,n.jsx)(l.e,{id:e.id,onSuccess:r},"delete")],children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[e.tags?.length>0&&(0,n.jsx)("div",{className:"mb-3",children:e.tags?.map(e=>n.jsx(a.vwO,{className:"mr-1 mb-1",children:e},e))}),(0,n.jsx)("div",{className:"mb-3",children:(0,n.jsx)(a.vwO,{color:e.enabled?"success":"error",children:e.enabled?"启用":"禁用"})})]}),(0,n.jsx)("div",{className:"mb-3",children:(0,n.jsx)(a.o5u.Paragraph,{ellipsis:{rows:5},children:e.content})}),e.project&&(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("strong",{className:"mr-1",children:"项目:"}),(0,n.jsx)("span",{children:e.project})]})]})},e.id))})};s()}catch(e){s(e)}})},13050:(e,t,r)=>{"use strict";r.d(t,{y:()=>n});let s=e=>{let t;let r=new Set,s=(e,s)=>{let n="function"==typeof e?e(t):e;if(!Object.is(n,t)){let e=t;t=(null!=s?s:"object"!=typeof n||null===n)?n:Object.assign({},t,n),r.forEach(r=>r(t,e))}},n=()=>t,a={setState:s,getState:n,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},i=t=e(s,n,a);return a},n=e=>e?s(e):s},17862:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=r(24332),n=r(48819),a=r(67851),i=r.n(a),l=r(97540),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d={children:["",{children:["role",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,78933)),"/Users/wangzhenyu/Code/work/persons/app/src/app/role/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,85631)),"/Users/wangzhenyu/Code/work/persons/app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,19033,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,39956,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,92341,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["/Users/wangzhenyu/Code/work/persons/app/src/app/role/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/role/page",pathname:"/role",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},23381:(e,t,r)=>{"use strict";r.d(t,{b:()=>s});let s=(0,r(2051).vt)(e=>({filterValues:{enabled:void 0,title:"",tag:""},setFilterValues:t=>{e(e=>({filterValues:{...e.filterValues,...t}}))}}))},28575:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>p});var n=r(13486),a=r(60159),i=r(35412),l=r(34893),o=r(97132),d=r(23381),c=r(21543),u=e([i,l,c]);[i,l,c]=u.then?(await u)():u;let p=()=>{let{filterValues:e,setFilterValues:t}=(0,d.b)(),r=(0,a.useMemo)(()=>{let t={};return void 0!==e.enabled&&(t.enabled=e.enabled),e.title&&(t.title={contains:e.title}),e.tag&&(t.tags={equals:[e.tag]}),t},[e]),{listState:s}=(0,c.wy)({list:{query:{where:r,orderBy:{createdAt:"desc"}}}}),u=(0,a.useMemo)(()=>{if(!s.data)return[];let e=new Set;return s.data.forEach(t=>{t.tags&&Array.isArray(t.tags)&&t.tags.forEach(t=>e.add(t))}),Array.from(e).map(e=>({label:e,value:e}))},[s.data]);return(0,n.jsxs)("div",{className:"p-5 mx-auto",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-medium text-gray-900",children:"角色管理"}),(0,n.jsx)(l.G_,{onSuccess:s.refetch})]}),(0,n.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,n.jsxs)("div",{className:"flex items-center gap-4 w-full",children:[(0,n.jsx)(i.aaP,{value:e.enabled,options:o.c,style:{width:300},onChange:e=>t({enabled:e})}),(0,n.jsx)(i.l6P,{placeholder:"根据标签筛选",allowClear:!0,style:{width:300},value:e.tag,options:u,onChange:e=>t({tag:e})}),(0,n.jsx)(i.pde,{placeholder:"搜索标题",allowClear:!0,value:e.title,onChange:e=>t({title:e.target.value})})]})}),(0,n.jsx)(i.tKH,{spinning:s.isLoading,delay:100,children:(0,n.jsx)(l.XD,{list:s.data,onSuccess:s.refetch})})]})};s()}catch(e){s(e)}})},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34589:e=>{"use strict";e.exports=require("node:assert")},34893:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{G_:()=>n.G,XD:()=>i.X});var n=r(70948),a=r(87778),i=r(12375),l=e([n,a,i]);[n,a,i]=l.then?(await l)():l,s()}catch(e){s(e)}})},51455:e=>{"use strict";e.exports=require("node:fs/promises")},57975:e=>{"use strict";e.exports=require("node:util")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64904:(e,t,r)=>{"use strict";var s=r(60159),n=r(52826),a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=n.useSyncExternalStore,l=s.useRef,o=s.useEffect,d=s.useMemo,c=s.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,r,s,n){var u=l(null);if(null===u.current){var p={hasValue:!1,value:null};u.current=p}else p=u.current;var h=i(e,(u=d(function(){function e(e){if(!o){if(o=!0,i=e,e=s(e),void 0!==n&&p.hasValue){var t=p.value;if(n(t,e))return l=t}return l=e}if(t=l,a(i,e))return t;var r=s(e);return void 0!==n&&n(t,r)?(i=e,t):(i=e,l=r)}var i,l,o=!1,d=void 0===r?null:r;return[function(){return e(t())},null===d?void 0:function(){return e(d())}]},[t,r,s,n]))[0],u[1]);return o(function(){p.hasValue=!0,p.value=h},[h]),c(h),h}},70948:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{G:()=>c});var n=r(13486),a=r(60159),i=r(35412),l=r(21543),o=r(15568),d=e([i,l]);[i,l]=d.then?(await d)():d;let c=e=>{let{initialValues:t,onSuccess:r}=e,[s]=i.lVW.useForm(),[d,{setTrue:c,setFalse:u}]=(0,o.useBoolean)(!1),[p,h]=(0,a.useState)("edit"),[x,m]=(0,a.useState)(""),{listState:f}=(0,l.sk)({list:{query:{where:{enabled:!0},orderBy:{createdAt:"desc"}}}}),b=(0,a.useMemo)(()=>{let e=x,t=f.data||[];return x&&t.length>0&&(e=x.replace(/@([^\n@]+?)(?=\n|@|$)/g,(e,r)=>{let s=r.trim(),n=t.find(e=>e.title===s);return n&&n.content||e})),e},[x,f.data]),{createState:v,updateState:g}=(0,l.wy)({list:!1,create:{onSuccess:()=>{y(),r?.()}},update:{onSuccess:()=>{y(),r?.()}}});(0,a.useEffect)(()=>{if(t&&d){let e={title:t.title,content:t.content,tags:t.tags||[],project:t.project||void 0,enabled:void 0===t.enabled||t.enabled};s.setFieldsValue(e),m(e.content)}else s.resetFields(),m("")},[s,t,d]);let y=()=>{u(),s.resetFields(),h("edit"),m("")},j=async()=>{await s.validateFields();let e=s.getFieldsValue();t?.id?g.mutate(t.id,e):v.mutate(e)},w=(f.data||[]).map(e=>({key:e.id,value:e.title,label:e.title}));return(0,n.jsxs)(n.Fragment,{children:[t?(0,n.jsx)(i.$nd,{type:"text",icon:(0,n.jsx)(i.xjh,{}),onClick:c}):(0,n.jsx)(i.$nd,{type:"primary",icon:(0,n.jsx)(i.bW0,{}),onClick:c,children:"添加角色"}),(0,n.jsx)(i._s,{title:t?"编辑角色":"新建角色",open:d,onClose:y,width:"80%",extra:(0,n.jsx)(i.$nd,{type:"primary",onClick:j,loading:v.isPending||g.isPending,children:"保存"}),children:(0,n.jsx)(i.tUM,{activeKey:p,onChange:h,items:[{key:"edit",label:"编辑",children:(0,n.jsxs)(i.lVW,{form:s,layout:"horizontal",labelCol:{span:2},wrapperCol:{span:21},initialValues:{enabled:!0},children:[(0,n.jsx)(i.lVW.Item,{name:"enabled",label:"状态",valuePropName:"checked",children:(0,n.jsx)(i.dOG,{})}),(0,n.jsx)(i.lVW.Item,{name:"title",label:"标题",rules:[{required:!0,message:"请输入标题"}],children:(0,n.jsx)(i.pde,{placeholder:"请输入标题"})}),(0,n.jsx)(i.lVW.Item,{name:"tags",label:"标签",rules:[{required:!0,message:"请添加标签"}],children:(0,n.jsx)(i.l6P,{placeholder:"输入标签后按回车",mode:"tags"})}),(0,n.jsx)(i.lVW.Item,{name:"content",label:"内容",rules:[{required:!0,message:"请输入内容"}],children:(0,n.jsx)(i.MW8,{placeholder:"请输入内容，输入 @ 可以提及信息项",autoSize:{minRows:15,maxRows:27},options:w,onChange:e=>{m(e),s.setFieldValue("content",e)}})})]})},{key:"preview",label:"预览",children:(0,n.jsx)("div",{className:"p-4 border rounded-md bg-white overflow-y-auto h-[830px]",children:(0,n.jsx)(i.ozN,{content:b})})}]})})]})};s()}catch(e){s(e)}})},73024:e=>{"use strict";e.exports=require("node:fs")},73136:e=>{"use strict";e.exports=require("node:url")},76760:e=>{"use strict";e.exports=require("node:path")},76830:e=>{"use strict";e.exports=require("prettier/parser-babel")},78877:e=>{"use strict";e.exports=require("node:v8")},78933:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(33952).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/wangzhenyu/Code/work/persons/app/src/app/role/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/wangzhenyu/Code/work/persons/app/src/app/role/page.tsx","default")},81816:(e,t,r)=>{"use strict";e.exports=r(64904)},83505:e=>{"use strict";e.exports=import("prettier/standalone")},87778:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{e:()=>o});var n=r(13486);r(60159);var a=r(35412),i=r(21543),l=e([a,i]);[a,i]=l.then?(await l)():l;let o=e=>{let{id:t,onSuccess:r}=e,{removeState:s}=(0,i.wy)({list:!1,remove:{onSuccess:r}});return(0,n.jsx)(a.iS5,{title:"确定删除该角色吗？",onConfirm:()=>{s.mutate(t)},okText:"确定",cancelText:"取消",children:(0,n.jsx)(a.$nd,{type:"link",danger:!0,icon:(0,n.jsx)(a.SUY,{})})})};s()}catch(e){s(e)}})},89116:e=>{"use strict";e.exports=require("vscode-oniguruma")},92417:(e,t,r)=>{Promise.resolve().then(r.bind(r,78933))},97132:(e,t,r)=>{"use strict";r.d(t,{c:()=>s});let s=[{label:"全部",value:void 0},{label:"启用",value:!0},{label:"禁用",value:!1}]},98995:e=>{"use strict";e.exports=require("node:module")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[734,661,206,571,543],()=>r(17862));module.exports=s})();