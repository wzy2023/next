(()=>{var e={};e.id=817,e.ids=[817],e.modules={1708:e=>{"use strict";e.exports=require("node:process")},2051:(e,t,r)=>{"use strict";r.d(t,{vt:()=>d});var s=r(13050),a=r(60159),n=r(81816);let{useDebugValue:i}=a,{useSyncExternalStoreWithSelector:o}=n,u=!1,l=e=>e,c=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?(0,s.y)(e):e,r=(e,r)=>(function(e,t=l,r){r&&!u&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),u=!0);let s=o(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return i(s),s})(t,e,r);return Object.assign(r,t),r},d=e=>e?c(e):c},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3870:(e,t,r)=>{Promise.resolve().then(r.bind(r,72434))},7273:e=>{"use strict";e.exports=require("prettier/parser-typescript")},9890:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{D:()=>d});var a=r(13486),n=r(60159),i=r(35412),o=r(44595),u=r(49725),l=r(92064),c=e([i]);i=(c.then?(await c)():c)[0];let d=e=>{let{data:t,mode:r}=e,s=(0,n.useRef)(null),c=t?.record?.progress??0,d=t?.status?.[r]??(t.enabled?l.HabitProgressStatus.Enabled:l.HabitProgressStatus.Disabled)??l.HabitProgressStatus.Pending;(0,n.useEffect)(()=>{s.current=d},[d]);let p=d===l.HabitProgressStatus.Done&&s.current!==l.HabitProgressStatus.Done,b=t?.frequency.type,h=u.dw[b];return(0,a.jsx)(i.Exy,{color:"#f50",count:b!==l.HabitFrequencyType.DAILY?h:"",offset:[-8,8],style:{zoom:.9},children:(0,a.jsx)(i.Wlx,{colors:u.dF[d],progress:t.record?.progress,showRing:c>0&&c<1,className:p?"animate-complete":"",children:(0,o.j)(t.name)})})};s()}catch(e){s(e)}})},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13050:(e,t,r)=>{"use strict";r.d(t,{y:()=>a});let s=e=>{let t;let r=new Set,s=(e,s)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=s?s:"object"!=typeof a||null===a)?a:Object.assign({},t,a),r.forEach(r=>r(t,e))}},a=()=>t,n={setState:s,getState:a,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},i=t=e(s,a,n);return n},a=e=>e?s(e):s},13818:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>d,pages:()=>c,routeModule:()=>p,tree:()=>l});var s=r(24332),a=r(48819),n=r(67851),i=r.n(n),o=r(97540),u={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(u[e]=()=>o[e]);r.d(t,u);let l={children:["",{children:["habit",{children:["record",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,53715)),"/Users/wangzhenyu/Code/work/persons/app/src/app/habit/record/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,15224)),"/Users/wangzhenyu/Code/work/persons/app/src/app/habit/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,85631)),"/Users/wangzhenyu/Code/work/persons/app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,19033,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,39956,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,92341,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["/Users/wangzhenyu/Code/work/persons/app/src/app/habit/record/page.tsx"],d={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/habit/record/page",pathname:"/habit/record",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},15224:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(33952).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/wangzhenyu/Code/work/persons/app/src/app/habit/layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/wangzhenyu/Code/work/persons/app/src/app/habit/layout.tsx","default")},17837:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>l});var a=r(13486);r(60159);var n=r(35412),i=r(37157),o=r(32137),u=e([n,i,o]);[n,i,o]=u.then?(await u)():u;let l=()=>{let{selectedDate:e,setSelectedDate:t}=(0,o.hI)(),{filterValues:r,setFilterValues:s}=(0,o.G_)(),{data:u,isLoading:l,invalidate:c}=(0,o.Ez)(e),{options:d}=(0,o.II)(u,r),{showData:p}=(0,o.Q8)(u,r);return(0,a.jsxs)("div",{className:"p-5 max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-medium text-gray-900",children:"习惯记录"}),(0,a.jsx)(n.qJP,{value:e,onChange:t})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(n.aaP,{value:r.frequency,options:d.frequency,onChange:e=>s({frequency:e})}),(0,a.jsx)(n.aaP,{value:r.status,options:d.status,onChange:e=>s({status:e})})]}),(0,a.jsx)(n.tKH,{spinning:l,delay:100,children:(0,a.jsx)(i._,{data:p,onSuccess:c})})]})};s()}catch(e){s(e)}})},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},24135:(e,t,r)=>{"use strict";r.d(t,{h:()=>a});var s=r(65067);let a=()=>{let{selectedDate:e,setSelectedDate:t}=(0,s.m)();return{selectedDate:e,setSelectedDate:t}}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},32137:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{Ez:()=>a.E,G_:()=>u.G,II:()=>n.I,Q8:()=>i.Q,hI:()=>o.h});var a=r(81106),n=r(62270),i=r(82192),o=r(24135),u=r(70426),l=e([a]);a=(l.then?(await l)():l)[0],s()}catch(e){s(e)}})},33873:e=>{"use strict";e.exports=require("path")},34589:e=>{"use strict";e.exports=require("node:assert")},36647:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a,f:()=>n});var s=r(17121);let a=e=>({count:e.count?.single||1,time:(0,s.yf)().format("YYYY-MM-DD HH:mm:ss")}),n=(e,t)=>e?.filter(e=>e.frequency?.type===t).length},37157:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{_:()=>u});var a=r(13486);r(60159);var n=r(35412),i=r(56649),o=e([n,i]);[n,i]=o.then?(await o)():o;let u=e=>{let{data:t,onSuccess:r}=e;return(0,a.jsx)(n.A9v,{direction:"vertical",children:t?.map(e=>a.jsx(n.ZpM,{size:"small",title:e.group.name,children:a.jsx(i.k,{list:e.list,onSuccess:r})},e.group.id))})};s()}catch(e){s(e)}})},44595:(e,t,r)=>{"use strict";r.d(t,{j:()=>s});let s=e=>{if(e.length<=3)return e;let t=Math.min(3,Math.ceil(e.length/2));return e.substring(0,t)+"\n"+s(e.substring(t))}},49725:(e,t,r)=>{"use strict";r.d(t,{GX:()=>n,dw:()=>i,Rx:()=>a,dF:()=>o,xW:()=>u});var s=r(92064);let a={[s.HabitProgressStatus.Disabled]:"已禁用",[s.HabitProgressStatus.Enabled]:"已启用",[s.HabitProgressStatus.Pending]:"待开始",[s.HabitProgressStatus.Doing]:"进行中",[s.HabitProgressStatus.Done]:"已完成",[s.HabitProgressStatus.Failed]:"已失败"},n={[s.HabitFrequencyType.DAILY]:"每日",[s.HabitFrequencyType.WEEKLY]:"每周",[s.HabitFrequencyType.MONTHLY]:"每月"},i={[s.HabitFrequencyType.DAILY]:"日",[s.HabitFrequencyType.WEEKLY]:"周",[s.HabitFrequencyType.MONTHLY]:"月"},o={[s.HabitProgressStatus.Enabled]:{bg:"bg-blue-500 hover:bg-blue-600",ring:""},[s.HabitProgressStatus.Disabled]:{bg:"bg-gray-400 hover:bg-gray-500",ring:""},[s.HabitProgressStatus.Pending]:{bg:"bg-gray-300 hover:bg-gray-400",ring:""},[s.HabitProgressStatus.Done]:{bg:"bg-green-500 hover:bg-green-600",ring:""},[s.HabitProgressStatus.Doing]:{bg:"bg-yellow-500 hover:bg-yellow-600",ring:"text-yellow-300"},[s.HabitProgressStatus.Failed]:{bg:"text-red-300 hover:bg-red-600",ring:"bg-red-500"}},u=[{label:"复制粘贴",value:s.ButtonsType.Copy},{label:"执行命令",value:s.ButtonsType.Command}]},51455:e=>{"use strict";e.exports=require("node:fs/promises")},53715:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(33952).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/wangzhenyu/Code/work/persons/app/src/app/habit/record/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/wangzhenyu/Code/work/persons/app/src/app/habit/record/page.tsx","default")},56649:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{k:()=>f});var a=r(13486),n=r(60159),i=r(35412),o=r(9890),u=r(89838),l=r(36647),c=r(65067),d=r(15568),p=r(21543),b=r(92064),h=e([i,o,u,p]);[i,o,u,p]=h.then?(await h)():h;let f=e=>{let{list:t,onSuccess:r}=e,s=(0,n.useRef)(null),{selectedDate:h}=(0,c.m)(),{createState:f,updateState:m}=(0,p.z)({showTip:!1,list:!1}),y=async(e,t)=>{if(t.execList){if(!e.record){await f.mutateAsync({habitId:e.id,execList:t.execList,date:h.toDate()}),r?.(e);return}await m.mutateAsync(e.record.id,{execList:t.execList,reason:t.reason}),r?.(e)}},g=(0,d.useClick)({onClick:e=>{if(Number(e.record?.progress)>=1)return;let t=e.record?.execList||[];t.push((0,l.Z)(e)),y(e,{execList:t})},onDoubleClick:e=>{i.aFV.confirm({title:`习惯 [${e.name}]`,width:600,content:(0,a.jsx)(u.k,{ref:s,data:e}),onOk:async()=>{await s.current?.validateFields();let t=s.current?.getFieldsValue();y(e,t)}})}});return(0,a.jsx)(i.A9v,{children:t.sort((e,t)=>e.sort-t.sort).map(e=>(0,a.jsx)("div",{onClick:()=>g(e),children:(0,a.jsx)(o.D,{data:e,mode:b.HabitStatusMode.Record})},`${e.id}-${e.record?.id}`))})};s()}catch(e){s(e)}})},57975:e=>{"use strict";e.exports=require("node:util")},62270:(e,t,r)=>{"use strict";r.d(t,{I:()=>o});var s=r(60159),a=r(17121),n=r(36647),i=r(49725);let o=(e,t)=>({options:(0,s.useMemo)(()=>({frequency:Object.keys(a._.groupBy(e,e=>e.frequency?.type)).map(t=>({label:i.GX[t]+` (${(0,n.f)(e,t)})`,value:t})),status:[{label:"全部",value:null},...Object.keys(a._.groupBy(e?.filter(e=>e.frequency?.type===t?.frequency),e=>e.status?.record)).map(e=>({label:i.Rx[e],value:e}))]}),[e,t?.frequency])})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64053:(e,t,r)=>{Promise.resolve().then(r.bind(r,17837))},64904:(e,t,r)=>{"use strict";var s=r(60159),a=r(52826),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=a.useSyncExternalStore,o=s.useRef,u=s.useEffect,l=s.useMemo,c=s.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,r,s,a){var d=o(null);if(null===d.current){var p={hasValue:!1,value:null};d.current=p}else p=d.current;var b=i(e,(d=l(function(){function e(e){if(!u){if(u=!0,i=e,e=s(e),void 0!==a&&p.hasValue){var t=p.value;if(a(t,e))return o=t}return o=e}if(t=o,n(i,e))return t;var r=s(e);return void 0!==a&&a(t,r)?(i=e,t):(i=e,o=r)}var i,o,u=!1,l=void 0===r?null:r;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]},[t,r,s,a]))[0],d[1]);return u(function(){p.hasValue=!0,p.value=b},[b]),c(b),b}},65067:(e,t,r)=>{"use strict";r.d(t,{m:()=>n});var s=r(2051),a=r(17121);let n=(0,s.vt)(e=>({selectedDate:(0,a.yf)().startOf("day"),setSelectedDate:t=>{e({selectedDate:t.startOf("day")})},filterValues:{frequency:null,status:null},setFilterValues:t=>{e(e=>({filterValues:{...e.filterValues,...t}}))}}))},70426:(e,t,r)=>{"use strict";r.d(t,{G:()=>a});var s=r(65067);let a=()=>{let{filterValues:e,setFilterValues:t}=(0,s.m)();return{filterValues:e,setFilterValues:t}}},72434:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(13486);r(60159);var a=r(2984),n=r(40903);function i({children:e}){let t=(0,a.useRouter)(),r=(0,a.usePathname)();return(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)(n.A,{activeKey:r.includes("/habit/record")?"record":"manage",onChange:e=>{"manage"===e?t.push("/habit/manage"):"record"===e&&t.push("/habit/record")},items:[{key:"manage",label:"习惯管理"},{key:"record",label:"习惯记录"}]}),e]})}},73024:e=>{"use strict";e.exports=require("node:fs")},73136:e=>{"use strict";e.exports=require("node:url")},73781:(e,t,r)=>{Promise.resolve().then(r.bind(r,53715))},76760:e=>{"use strict";e.exports=require("node:path")},76830:e=>{"use strict";e.exports=require("prettier/parser-babel")},78877:e=>{"use strict";e.exports=require("node:v8")},80310:(e,t,r)=>{Promise.resolve().then(r.bind(r,15224))},81106:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{E:()=>u});var a=r(60159),n=r(74481),i=r(92064),o=e([n]);n=(o.then?(await o)():o)[0];let u=e=>{let t=n.F.custom.habitItem.list.useQuery({date:e.valueOf()}),r=e.subtract(1,"day").valueOf(),s=e.add(1,"day").valueOf(),o=n.F.useUtils();return(0,a.useEffect)(()=>{o.custom.habitItem.list.prefetch({date:r}),o.custom.habitItem.list.prefetch({date:s})},[o,s,r]),{data:t.data,refetch:t.refetch,isLoading:t.isLoading,invalidate:t=>{o.custom.habitItem.list.refetch({date:e.valueOf()}),t.frequency?.type!==i.HabitFrequencyType.DAILY&&(o.custom.habitItem.list.refetch({date:r}),o.custom.habitItem.list.refetch({date:s}))}}};s()}catch(e){s(e)}})},81816:(e,t,r)=>{"use strict";e.exports=r(64904)},82192:(e,t,r)=>{"use strict";r.d(t,{Q:()=>n});var s=r(60159),a=r(17121);let n=(e,t)=>({showData:(0,s.useMemo)(()=>{let r=e?.filter(e=>!(t?.frequency&&e.frequency?.type!==t.frequency||t?.status&&e.status.record!==t.status));return Object.entries(a._.groupBy(r,e=>e.groupId)).map(([,e])=>({group:e[0].group,list:e})).sort((e,t)=>(e.group?.sort||0)-(t.group?.sort||0))},[e,t])})},83505:e=>{"use strict";e.exports=import("prettier/standalone")},89116:e=>{"use strict";e.exports=require("vscode-oniguruma")},89838:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{k:()=>l});var a=r(13486),n=r(60159),i=r(35412),o=r(36647),u=e([i]);i=(u.then?(await u)():u)[0];let l=(0,n.forwardRef)((e,t)=>{let{data:r}=e,[s]=i.lVW.useForm();return(0,a.jsx)("div",{className:"mt-5",children:(0,a.jsxs)(i.lVW,{ref:t,form:s,labelCol:{span:4},initialValues:{execList:r?.record?.execList,reason:r?.record?.reason},children:[(0,a.jsx)(i.lVW.Item,{label:"执行记录",children:(0,a.jsx)(i.lVW.List,{name:"execList",children:(e,{add:t,remove:s})=>(0,a.jsxs)(a.Fragment,{children:[e.map(({key:e,name:t,...r})=>(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)(i.A9v,{children:[(0,a.jsx)(i.lVW.Item,{...r,name:[t,"count"],rules:[{required:!0,message:"请输入数量"}],children:(0,a.jsx)(i.YIz,{min:1,placeholder:"数量"})}),(0,a.jsx)(i.lVW.Item,{...r,name:[t,"time"],rules:[{required:!0,message:"请选择日期"}],children:(0,a.jsx)(i.pde,{disabled:!0})}),(0,a.jsx)(i.lVW.Item,{...r,name:[t,"feeling"],children:(0,a.jsx)(i.l6P,{placeholder:"完成感受",options:[{label:"非常棒",value:"excellent"},{label:"不错",value:"good"},{label:"一般",value:"normal"},{label:"不太好",value:"bad"},{label:"很差",value:"terrible"}]})}),(0,a.jsx)(i.lVW.Item,{children:(0,a.jsx)(i.$nd,{type:"text",danger:!0,onClick:()=>s(t),children:"删除"})})]})},e)),(0,a.jsx)(i.$nd,{onClick:()=>t((0,o.Z)(r)),type:"dashed",block:!0,children:"添加记录"})]})})}),(0,a.jsx)(i.lVW.Item,{name:"reason",label:"未完成原因",children:(0,a.jsx)(i.pde.TextArea,{placeholder:"请输入未完成的原因（选填）",rows:3})})]})})});s()}catch(e){s(e)}})},92064:(e,t,r)=>{"use strict";r.d(t,{ButtonsType:()=>i,CollectingType:()=>o,HabitFrequencyType:()=>s,HabitProgressStatus:()=>a,HabitStatusMode:()=>n,RssFeedActionType:()=>u.lQ,RssFetchTriggerType:()=>u.ln,RssFrequency:()=>u.b4,RssItemActionType:()=>u._1});var s=function(e){return e.DAILY="DAILY",e.WEEKLY="WEEKLY",e.MONTHLY="MONTHLY",e}({}),a=function(e){return e.Disabled="disabled",e.Enabled="enabled",e.Pending="pending",e.Doing="doing",e.Done="done",e.Failed="failed",e}({}),n=function(e){return e.Habit="habit",e.Record="record",e}({});r(95985);var i=function(e){return e.Command="command",e.Copy="copy",e}({}),o=function(e){return e.Url="url",e.Prompt="prompt",e.Copy="copywriter",e}({}),u=r(96602)},95985:()=>{},96602:(e,t,r)=>{"use strict";r.d(t,{_1:()=>n,b4:()=>s,lQ:()=>i,ln:()=>a});var s=function(e){return e.Minutes5="minutes5",e.Minutes10="minutes10",e.Minutes20="minutes20",e.Minutes30="minutes30",e.Hourly="hourly",e.Daily="daily",e.Weekly="weekly",e}({}),a=function(e){return e.Manual="manual",e.Scheduled="scheduled",e}({}),n=function(e){return e.MarkAsRead="markAsRead",e.MarkAsUnread="markAsUnread",e.Star="star",e.Unstar="unstar",e.OpenLink="openLink",e}({}),i=function(e){return e.Edit="edit",e.Delete="delete",e.Enable="enable",e.Disable="disable",e.Fetch="fetch",e}({})},98995:e=>{"use strict";e.exports=require("node:module")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[734,661,206,571,543],()=>r(13818));module.exports=s})();